情景
------
现有一个物品供玩家使用, 此物品功能有:
- 右键后开始蓄力
- 蓄力状态下不断增加蓄力进度
- 右键后取消蓄力（需正在蓄力）
- 左键后发射火球（需蓄力进度 ≥ 33%）
- 火球的攻击段数、最大移动距离、球体特效半径受 蓄力阶段影响, 蓄力阶段又被 蓄力进度影响 共3段
- 蓄力完成后可继续蓄力, 但不会增加蓄力进度
火球技能
单击右键开始蓄力
再次摁下右键取消蓄力
技能共分三个阶段
「蓄力33/66/100%」
火球的距离 范围 伤害段数随阶段数递增
单击左键结束蓄力 释放火球技能
- 本教程所用机制占比：[占位符](/技能/占位符) 100%

[![](https://s20.directupload.net/images/210824/69h2je2m.gif)]

原理 （无载体）
------

前置 Crucible 因要做到左右键  
蓄力读数（增加蓄力进度）使用 [占位符](/技能/占位符)） （与计时器做法差不多）  
蓄力阶段对抛射物的影响需要使用重复激活来做到（重复激活的值支持 [占位符](/技能/占位符)）  
蓄力提示涉及到 2个 [占位符](/技能/占位符)） 


涉及技能 / 条件
------

- [Skill](/技能/列表/skill)
- [Set Variable](/技能/列表/setvariable)
- [Send Title Message](/技能/列表/sendtitlemessage)
- [Variable In Range](/条件/variableinrange)

步骤1: 右键后开始蓄力
------

首先是物品配置叭..用到了[触发器: ~onUse](/技能/触发器)(右键后激活)

### 物品配置

    蓄力物品:
      Id: iron_sword
      Display: '可蓄力物品'
      Skills:
      - skill:蓄力 @self ~onUse

### 技能组配置

    蓄力:
      Conditions:
      - variableinrange{var=caster.蓄力开关;v=1} false
      Cooldown: 0.1
      Skills:
      - setvariable{var=caster.蓄力阶段提示;type=float;value="0"} @self
      - setvariable{var=caster.蓄力进度;type=float;value="0"} @self
      - setvariable{var=caster.蓄力开关;type=float;value="0"} @self
      - setvariable{var=caster.蓄力开关;type=float;value="<caster.var.蓄力开关> + 0.5";repeat=1;repeatInterval=1} @self

技能组: 蓄力 对自身的要求为: 自身身上的变量: 蓄力开关的值 ≠ 1  
技能组: 蓄力的内容为  
设置自身身上的变量: 蓄力阶段提示 值为 0  
设置自身身上的变量: 蓄力进度 值为 0  
设置自身身上的变量: 蓄力开关 值为 0  
重复激活俩次，激活间隔1tick, 设置自身身上的变量: 蓄力开关 值为 自身身上蓄力开关的值 - 0.5  
 
为啥变量: 蓄力开关 涉及到俩行Setvariable, 甚至重复激活? 将在下一步的时候解释

这样 玩家右键物品后 这四行 Setvariable 就相当于将整个机制用到的 所有变量 设为 默认值

步骤2: 蓄力状态下不断增加蓄力进度
-------------

物品配置叭..用到了[触发器: ~onTimer:](/技能/触发器)(右键后激活)

### 物品配置

    蓄力物品:
      Id: iron_sword
      Display: '可蓄力物品'
      Skills:
      - skill:蓄力 @self ~onUse
      - skill:蓄力读数 @self ~onTimer:1

每1tick 激活技能组: 蓄力读数（用于不断加值）

### 技能组配置

    蓄力读数:
      Conditions:
      - variableinrange{var=caster.蓄力开关;v=1}
      Skills:
      - setvariable{var=caster.蓄力进度;type=float;value="<caster.var.蓄力进度> + 0.05"} @self

技能组：蓄力读数 对自身的要求为: "自身身上的变量: 蓄力开关 的值为 1（注意步骤1的描述 相当于开始蓄力）"  
技能组：蓄力读数的内容为: "设置自身身上的变量: 蓄力进度 值为 自身身上的变量: 蓄力进度的值 + 0.05"  
1tick + 0.05, 20tick + 1（也就是+1/秒）